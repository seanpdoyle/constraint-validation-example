<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title># Constraint Validation Example
</title>
    <link href="stylesheets/site.css" rel="stylesheet" />
    <script src="javascripts/site.js"></script>
  </head>
  <body class="page">
    <header class="header">
      <h1 class="header__name">
<a href="./" aria-current="page">          constraint-validation-example
</a>      </h1>


      <nav class="
        header__navigation
        navigation
        navigation--next
      ">
<a href="commits/5545fe8a221966fb48731709f57604458683afee/">            Get Started &#8594;
</a>      </nav>
    </header>

    <main class="content">
      <details class="accordion content__item">
        <summary class="accordion__summary">
          <div class="accordion__closed">
            <nav class="
              commit-history
              u-db-overflow-y--auto
              u-mb-overflow-x--scroll
            ">
                <a href="commits/5545fe8a221966fb48731709f57604458683afee/" class="commit-node commit-node--collapsed" title="[SKIP]: Create `git-read` GitHub Action
"></a>
                <a href="commits/848b575b23dd386b8dae7baaf0b6917248626c8c/" class="commit-node commit-node--collapsed" title="[GENERATED]: Initial Commit
"></a>
                <a href="commits/8514a28f2ae814bf83126ee296e74d75ecac774d/" class="commit-node commit-node--collapsed" title="[GENERATED]: Install ActiveStorage and ActionText
"></a>
                <a href="commits/aa205e258c1c81cf66e11af84c30fcbef4a671c8/" class="commit-node commit-node--collapsed" title="[GENERATED]: Webpacker support for Typescript
"></a>
                <a href="commits/5979fc333df3332acd92434898d83e878c8df8ef/" class="commit-node commit-node--collapsed" title="[SKIP]: Install TailwindCSS
"></a>
                <a href="commits/6c02ab3a95d59cfbe7db9d17fc4cd741a1169754/" class="commit-node commit-node--collapsed" title="Explain the project in the README.md"></a>
                <a href="commits/b84a43ef9166c315e0d9007e8f1c2eeaba520145/" class="commit-node commit-node--collapsed" title="Store invalid submission parameters in the Flash
"></a>
                <a href="commits/3fb4b2762304c6772e6fb83a4b4fc0b79981bfa9/" class="commit-node commit-node--collapsed" title="Add System tests for Validation Messages A11y
"></a>
                <a href="commits/5fa1d1117ab87280d9bcd5d03851c5dd9c520982/" class="commit-node commit-node--collapsed" title="Add Users and require Authentication for messaging
"></a>
                <a href="commits/4c76dc815a68739452c5b60eaae905dc39bfd39a/" class="commit-node commit-node--collapsed" title="ActionView::Helpers::FormBuilder extensions
"></a>
                <a href="commits/e7dcacb69eafefd590576ea283dde744230dd7d1/" class="commit-node commit-node--collapsed" title="Abstract how fields reference validation messages
"></a>
                <a href="commits/e0b3ccf54edeef33bab1bf6912fa21a78e7bdcf7/" class="commit-node commit-node--collapsed" title="Abstract Validation Message ID generation
"></a>
                <a href="commits/951bb63c88105d76e7f8570cb3880c432b0a4d61/" class="commit-node commit-node--collapsed" title="Abstract Validation Message rendering
"></a>
                <a href="commits/43a623bca8ea84e063e3056d642d6712972780cc/" class="commit-node commit-node--collapsed" title="Integrate with Browser Constraint Validation API
"></a>
                <a href="commits/cabc045344543ccabd6876ac541f5761c1206ed2/" class="commit-node commit-node--collapsed" title="Validation message from server
"></a>
                <a href="commits/db7ee42b83a4319a2c07eb32dd3cc1bb7cbcc765/" class="commit-node commit-node--collapsed" title="Dynamically disable invalid form submit buttons
"></a>
                <a href="commits/47ba0e492c16836c9ab639188d6cdaafd4bebd1c/" class="commit-node commit-node--collapsed" title="Style with TailwindCSS
"></a>
            </nav>

            <div class="accordion__toggle">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Expand History</title>
  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Expand History</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>

          <div class="accordion__opened">
            <div class="accordion__toggle accordion__toggle--fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>
        </summary>

        <nav class="
          commit-history
          commit-history--full
          u-db-overflow-y--auto
          u-mb-overflow-x--scroll
        ">
<a href="commits/5545fe8a221966fb48731709f57604458683afee/" class="commit-node commit-node--full">              <p>[SKIP]: Create <code>git-read</code> GitHub Action</p>

</a><a href="commits/848b575b23dd386b8dae7baaf0b6917248626c8c/" class="commit-node commit-node--full">              <p>[GENERATED]: Initial Commit</p>

</a><a href="commits/8514a28f2ae814bf83126ee296e74d75ecac774d/" class="commit-node commit-node--full">              <p>[GENERATED]: Install ActiveStorage and ActionText</p>

</a><a href="commits/aa205e258c1c81cf66e11af84c30fcbef4a671c8/" class="commit-node commit-node--full">              <p>[GENERATED]: Webpacker support for Typescript</p>

</a><a href="commits/5979fc333df3332acd92434898d83e878c8df8ef/" class="commit-node commit-node--full">              <p>[SKIP]: Install TailwindCSS</p>

</a><a href="commits/6c02ab3a95d59cfbe7db9d17fc4cd741a1169754/" class="commit-node commit-node--full">              <p>Explain the project in the README.md</p>

</a><a href="commits/b84a43ef9166c315e0d9007e8f1c2eeaba520145/" class="commit-node commit-node--full">              <p>Store invalid submission parameters in the Flash</p>

</a><a href="commits/3fb4b2762304c6772e6fb83a4b4fc0b79981bfa9/" class="commit-node commit-node--full">              <p>Add System tests for Validation Messages A11y</p>

</a><a href="commits/5fa1d1117ab87280d9bcd5d03851c5dd9c520982/" class="commit-node commit-node--full">              <p>Add Users and require Authentication for messaging</p>

</a><a href="commits/4c76dc815a68739452c5b60eaae905dc39bfd39a/" class="commit-node commit-node--full">              <p>ActionView::Helpers::FormBuilder extensions</p>

</a><a href="commits/e7dcacb69eafefd590576ea283dde744230dd7d1/" class="commit-node commit-node--full">              <p>Abstract how fields reference validation messages</p>

</a><a href="commits/e0b3ccf54edeef33bab1bf6912fa21a78e7bdcf7/" class="commit-node commit-node--full">              <p>Abstract Validation Message ID generation</p>

</a><a href="commits/951bb63c88105d76e7f8570cb3880c432b0a4d61/" class="commit-node commit-node--full">              <p>Abstract Validation Message rendering</p>

</a><a href="commits/43a623bca8ea84e063e3056d642d6712972780cc/" class="commit-node commit-node--full">              <p>Integrate with Browser Constraint Validation API</p>

</a><a href="commits/cabc045344543ccabd6876ac541f5761c1206ed2/" class="commit-node commit-node--full">              <p>Validation message from server</p>

</a><a href="commits/db7ee42b83a4319a2c07eb32dd3cc1bb7cbcc765/" class="commit-node commit-node--full">              <p>Dynamically disable invalid form submit buttons</p>

</a><a href="commits/47ba0e492c16836c9ab639188d6cdaafd4bebd1c/" class="commit-node commit-node--full">              <p>Style with TailwindCSS</p>

</a>        </nav>
      </details>

      <article class="
        commit-content
        
        content__item
        content__item--grow
      ">
        <section class="commit commit--message">

          <h1 id="constraint-validation-example">Constraint Validation Example</h1>

<h2 id="how-to-read-this-repository">How to read this repository</h2>

<p>The <a href="https://github.com/seanpdoyle/constraint-validation-example/commits/main">commits</a> are structured to form a sequential narrative, iteratively and
incrementally building toward integrated client- and server-side validation
message rendering.</p>

<p>The commits earlier in the sequence use workable and somewhat naive
implementations to achieve the desired behavior, and are all covered by tests.</p>

<p>The later commits refine the implementation to a point where some valuable
abstractions emerge.</p>

<p>While reading the commits, feel free to skip over commits prefaced by
<code>[GENERATED]</code> or <code>[SKIP]</code>.</p>

<h2 id="goals">Goals</h2>

<p>While most of this code strives to be exemplary user-land integrations with some
of these new concepts, it&rsquo;s a best-effort attempt. The authentication code might
not be production-grade security, but it serves its purpose here.</p>

<p>Any concepts that are intended to be extracted to their corresponding frameworks
are declared in directories separate from the application code. For example,
when possible, Rails extensions are declared within the <code>lib/rails_ext</code>
directory, and the <code>app/javascript/initializers/</code> directory on the
JavaScript-side.</p>

<p>As exceptions to that rule, the <code>app/models/concerns</code> and
<code>app/controllers/concerns</code> declare extract-able code.</p>

<h3 id="turbo">Turbo</h3>

<p>The first commit contains the only <em>truly</em> Turbo-specific work. It
addresses the Turbo requirements for form submission redirects through a
workaround that combines the <code>FlashHash</code> and <code>ActiveRecord::SessionStore</code>.</p>

<p>The rest of the work is Turbo-adjacent.</p>

<h3 id="actionview-and-accessibility">ActionView and Accessibility</h3>

<p>The current ActionView default configurations for <code>&lt;form&gt;</code> element construction
don&rsquo;t create accessible forms and fields.</p>

<p>Some of this work explores some possible extensions to ActionView that could
improve Rails&rsquo; baked in accessibility.</p>

<h3 id="actionview-and-the-constraint-validations-api">ActionView and the Constraint Validations API</h3>

<p>In addition to building more accessible forms and fields, the ActionView
extensions introduce some new concepts and patterns to improve the developer
experience around rendering ActiveModel validations in server-generated
HTML.</p>

<p>There are also complementary client-side patterns introduced to integrate with
the Browser-provided Constraint Validations API (you know, that thing that every
Rails app on the planet opts-out of by declaring <code>[novalidate]</code> attributes).</p>

<p>The inception of the concepts behind the JavaScript changes occurred with
RailsUJS-integration in mind, but it seems that Turbo will supplant RailsUJS and
make it obsolete and deprecated.</p>

<p>There ended up being <strong>zero</strong> lines of Turbo-dependent JavaScript code.</p>

<h2 id="testing-it-out-locally">Testing it out locally</h2>

<p>To test this out on your own, clone the repository and run the <code>bin/setup</code>
script, then run the test suite by running <code>bin/rails test:all</code>.</p>

        </section>

      </article>
    </main>
  </body>
</html>
