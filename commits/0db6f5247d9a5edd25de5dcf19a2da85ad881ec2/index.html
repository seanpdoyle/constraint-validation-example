<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Abstract Validation Message rendering
</title>
    <link href="../../stylesheets/site.css" rel="stylesheet" />
    <script src="../../javascripts/site.js"></script>
  </head>
  <body class="page">
    <header class="header">
      <h1 class="header__name">
<a href="../../">          constraint-validation-example
</a>      </h1>


      <nav class="
        header__navigation
        navigation
        
      ">
<a href="../bb788857f8347a538d0c822eccef81557362fa6f/">              &#8592; Previous
</a>
<a href="../54922ffc20ff2554ab323401894984c98af4e273/">              Next &#8594;
</a>      </nav>
    </header>

    <main class="content">
      <details class="accordion content__item">
        <summary class="accordion__summary">
          <div class="accordion__closed">
            <nav class="
              commit-history
              u-db-overflow-y--auto
              u-mb-overflow-x--scroll
            ">
                <a href="../df690458a353f4a2d7d5406bfb17d6c866a01eb9/" class="commit-node commit-node--collapsed" title="[SKIP]: Create `git-read` GitHub Action
"></a>
                <a href="../838be13608ca7728ef02691bf7c9662983859034/" class="commit-node commit-node--collapsed" title="[GENERATED]: Initial Commit
"></a>
                <a href="../1b2273b26f1ba1d4c8b8e13e2df68032abfa2e52/" class="commit-node commit-node--collapsed" title="[GENERATED]: Install ActiveStorage and ActionText
"></a>
                <a href="../80280feaf26536f46ad9ceb3234b4a03cfa5cde7/" class="commit-node commit-node--collapsed" title="[GENERATED]: Webpacker support for Typescript
"></a>
                <a href="../d97f90d3962aa14f7ff114f8721dcf3a028686da/" class="commit-node commit-node--collapsed" title="[SKIP]: Install TailwindCSS
"></a>
                <a href="../ca31f0105d5a8a8e2beafcb7d4502329cb9290cd/" class="commit-node commit-node--collapsed" title="Explain the project in the README.md"></a>
                <a href="../deb861c26f1411c2be53ceba230718aed86e0819/" class="commit-node commit-node--collapsed" title="Store invalid submission parameters in the Flash
"></a>
                <a href="../fdd439a3370b7316ab981dca43a56195f22048c1/" class="commit-node commit-node--collapsed" title="Add System tests for Validation Messages A11y
"></a>
                <a href="../0066995816650284f08abcaa79b4e9e9c28a2fca/" class="commit-node commit-node--collapsed" title="Add Users and require Authentication for messaging
"></a>
                <a href="../cfccd1d7073089bf276713751ff67e4bfc3c4169/" class="commit-node commit-node--collapsed" title="ActionView::Helpers::FormBuilder extensions
"></a>
                <a href="../de91a14dffbf6fb7eb2387041d8aac4920bade15/" class="commit-node commit-node--collapsed" title="Abstract how fields reference validation messages
"></a>
                <a href="../bb788857f8347a538d0c822eccef81557362fa6f/" class="commit-node commit-node--collapsed" title="Abstract Validation Message ID generation
"></a>
                <a href="./" class="commit-node commit-node--collapsed" title="Abstract Validation Message rendering
" aria-current="page"></a>
                <a href="../54922ffc20ff2554ab323401894984c98af4e273/" class="commit-node commit-node--collapsed" title="Integrate with Browser Constraint Validation API
"></a>
                <a href="../55be92feea8285636f13e4bc861e85210ea3bda4/" class="commit-node commit-node--collapsed" title="Validation message from server
"></a>
                <a href="../2e1a758b24bfe7d0b161817346c92134562aeba8/" class="commit-node commit-node--collapsed" title="Dynamically disable invalid form submit buttons
"></a>
                <a href="../6da5186702f274c8b35625b6e5a040fe481a0695/" class="commit-node commit-node--collapsed" title="Style with TailwindCSS
"></a>
            </nav>

            <div class="accordion__toggle">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Expand History</title>
  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Expand History</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>

          <div class="accordion__opened">
            <div class="accordion__toggle accordion__toggle--fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>
        </summary>

        <nav class="
          commit-history
          commit-history--full
          u-db-overflow-y--auto
          u-mb-overflow-x--scroll
        ">
<a href="../df690458a353f4a2d7d5406bfb17d6c866a01eb9/" class="commit-node commit-node--full">              <p>[SKIP]: Create <code>git-read</code> GitHub Action</p>

</a><a href="../838be13608ca7728ef02691bf7c9662983859034/" class="commit-node commit-node--full">              <p>[GENERATED]: Initial Commit</p>

</a><a href="../1b2273b26f1ba1d4c8b8e13e2df68032abfa2e52/" class="commit-node commit-node--full">              <p>[GENERATED]: Install ActiveStorage and ActionText</p>

</a><a href="../80280feaf26536f46ad9ceb3234b4a03cfa5cde7/" class="commit-node commit-node--full">              <p>[GENERATED]: Webpacker support for Typescript</p>

</a><a href="../d97f90d3962aa14f7ff114f8721dcf3a028686da/" class="commit-node commit-node--full">              <p>[SKIP]: Install TailwindCSS</p>

</a><a href="../ca31f0105d5a8a8e2beafcb7d4502329cb9290cd/" class="commit-node commit-node--full">              <p>Explain the project in the README.md</p>

</a><a href="../deb861c26f1411c2be53ceba230718aed86e0819/" class="commit-node commit-node--full">              <p>Store invalid submission parameters in the Flash</p>

</a><a href="../fdd439a3370b7316ab981dca43a56195f22048c1/" class="commit-node commit-node--full">              <p>Add System tests for Validation Messages A11y</p>

</a><a href="../0066995816650284f08abcaa79b4e9e9c28a2fca/" class="commit-node commit-node--full">              <p>Add Users and require Authentication for messaging</p>

</a><a href="../cfccd1d7073089bf276713751ff67e4bfc3c4169/" class="commit-node commit-node--full">              <p>ActionView::Helpers::FormBuilder extensions</p>

</a><a href="../de91a14dffbf6fb7eb2387041d8aac4920bade15/" class="commit-node commit-node--full">              <p>Abstract how fields reference validation messages</p>

</a><a href="../bb788857f8347a538d0c822eccef81557362fa6f/" class="commit-node commit-node--full">              <p>Abstract Validation Message ID generation</p>

</a><a href="./" class="commit-node commit-node--full" aria-current="page">              <p>Abstract Validation Message rendering</p>

</a><a href="../54922ffc20ff2554ab323401894984c98af4e273/" class="commit-node commit-node--full">              <p>Integrate with Browser Constraint Validation API</p>

</a><a href="../55be92feea8285636f13e4bc861e85210ea3bda4/" class="commit-node commit-node--full">              <p>Validation message from server</p>

</a><a href="../2e1a758b24bfe7d0b161817346c92134562aeba8/" class="commit-node commit-node--full">              <p>Dynamically disable invalid form submit buttons</p>

</a><a href="../6da5186702f274c8b35625b6e5a040fe481a0695/" class="commit-node commit-node--full">              <p>Style with TailwindCSS</p>

</a>        </nav>
      </details>

      <article class="
        commit-content
        commit-content--double
        content__item
        content__item--grow
      ">
        <section class="commit commit--message">

          <h1 id="abstract-validation-message-rendering">Abstract Validation Message rendering</h1>

<p>Declare <code>ValidationMessageFormBuilder#validation_message</code> to combine all
of the newly introduced <code>FormBuilder</code> concepts:</p>

<p>For fields <em>without any errors</em>, do nothing and render nothing.</p>

<p>When a field has any errors for the attribute, create an instance of
<code>ActionView::Helpers::TagHelper#tag</code> that is pre-built with the correct
DOM <code>[id]</code> attribute, generated by <code>validation_message_id</code>.</p>

<p>When passed block, yield the collection of <code>ActiveModel::Error</code>
instances along with the pre-built <code>tag</code>. The calling block is
responsible for building an element to contain the validation messages.</p>

<p>When a block <em>is not given</em>, render a <code>&lt;span&gt;</code> element with the
pre-built <code>tag</code> instance.</p>

<p>In either case, pass along any attributes passed as part of the options.</p>

        </section>

          <aside class="commit commit--diff commit--long-content">
              <details
  id="app/views/authentications/new.html.erb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/views/authentications/new.html.erb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/views/authentications/new.html.erb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/views/authentications/new.html.erb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/views/authentications/new.html.erb b/app/views/authentications/new.html.erb
index 8762274..6cc430b 100644
</span><span class="gd">--- a/app/views/authentications/new.html.erb
</span><span class="gi">+++ b/app/views/authentications/new.html.erb
</span><span class="p">@@ -1,28 +1,22 @@</span>
 &lt;%= form_with(model: authentication) do |form| %&gt;
<span class="gd">-  &lt;% form.errors(:base) do |errors| %&gt;
-    &lt;% if errors.any? %&gt;
-      &lt;%= tag.span errors.to_sentence, aria: { live: "assertive" } %&gt;
-    &lt;% end %&gt;
</span><span class="gi">+  &lt;%= form.validation_message :base, aria: { live: "assertive" } do |errors, tag| %&gt;
+    &lt;%= tag.p errors.to_sentence %&gt;
</span>   &lt;% end %&gt;
 
<span class="gd">-  &lt;% form.errors(:username) do |errors| %&gt;
-    &lt;%= form.label :username %&gt;
-    &lt;%= form.text_field :username, aria: {
-      describedby: form.validation_message_id(:username),
-    } %&gt;
-    &lt;% if errors.any? %&gt;
-      &lt;%= tag.span errors.to_sentence, id: form.validation_message_id(:username) %&gt;
-    &lt;% end %&gt;
</span><span class="gi">+  &lt;%= form.label :username %&gt;
+  &lt;%= form.text_field :username, aria: {
+    describedby: form.validation_message_id(:username),
+  } %&gt;
+  &lt;%= form.validation_message :username do |errors, tag| %&gt;
+    &lt;%= tag.span errors.to_sentence %&gt;
</span>   &lt;% end %&gt;
 
<span class="gd">-  &lt;% form.errors(:password) do |errors| %&gt;
-    &lt;%= form.label :password %&gt;
-    &lt;%= form.password_field :password, aria: {
-      describedby: form.validation_message_id(:password),
-    } %&gt;
-    &lt;% if errors.any? %&gt;
-      &lt;%= tag.span errors.to_sentence, id: form.validation_message_id(:password) %&gt;
-    &lt;% end %&gt;
</span><span class="gi">+  &lt;%= form.label :password %&gt;
+  &lt;%= form.password_field :password, aria: {
+    describedby: form.validation_message_id(:password),
+  } %&gt;
+  &lt;%= form.validation_message :password do |errors, tag| %&gt;
+    &lt;%= tag.span errors.to_sentence %&gt;
</span>   &lt;% end %&gt;
 
   &lt;%= form.button %&gt;
</code></pre></div></details>

              <details
  id="app/views/messages/index.html.erb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/views/messages/index.html.erb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/views/messages/index.html.erb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/views/messages/index.html.erb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/views/messages/index.html.erb b/app/views/messages/index.html.erb
index ff163b9..16ac38b 100644
</span><span class="gd">--- a/app/views/messages/index.html.erb
</span><span class="gi">+++ b/app/views/messages/index.html.erb
</span><span class="p">@@ -6,14 +6,12 @@</span>
 
 &lt;% if Current.user %&gt;
   &lt;%= form_with model: message do |form| %&gt;
<span class="gd">-    &lt;% form.errors(:content) do |errors| %&gt;
-      &lt;%= form.label :content %&gt;
-      &lt;%= form.rich_text_area :content, aria: {
-        describedby: form.validation_message_id(:content),
-      } %&gt;
-      &lt;% if errors.any? %&gt;
-        &lt;%= tag.span errors.to_sentence, id: form.validation_message_id(:content) %&gt;
-      &lt;% end %&gt;
</span><span class="gi">+    &lt;%= form.label :content %&gt;
+    &lt;%= form.rich_text_area :content, aria: {
+      describedby: form.validation_message_id(:content),
+    } %&gt;
+    &lt;%= form.validation_message :content do |errors, tag| %&gt;
+      &lt;%= tag.span errors.to_sentence %&gt;
</span>     &lt;% end %&gt;
 
     &lt;%= form.button %&gt;
</code></pre></div></details>

              <details
  id="config/application.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse config/application.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand config/application.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      config/application.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config/application.rb b/config/application.rb
index eed0811..e7e125c 100644
</span><span class="gd">--- a/config/application.rb
</span><span class="gi">+++ b/config/application.rb
</span><span class="p">@@ -15,5 +15,6 @@</span> module ConstraintValidationExample
     # Application configuration can go into files in config/initializers
     # -- all .rb files in that directory are automatically loaded after loading
     # the framework and any gems in your application.
<span class="gi">+    config.action_view.field_error_proc = proc { |html_tag| html_tag }
</span>   end
 end
</code></pre></div></details>

              <details
  id="lib/validation_message_form_builder.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse lib/validation_message_form_builder.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand lib/validation_message_form_builder.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      lib/validation_message_form_builder.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/lib/validation_message_form_builder.rb b/lib/validation_message_form_builder.rb
index deab166..e00eb16 100644
</span><span class="gd">--- a/lib/validation_message_form_builder.rb
</span><span class="gi">+++ b/lib/validation_message_form_builder.rb
</span><span class="p">@@ -1,4 +1,20 @@</span>
 class ValidationMessageFormBuilder &lt; ActionView::Helpers::FormBuilder
<span class="gi">+  def validation_message(field, **attributes, &amp;block)
+    errors field do |messages|
+      id = validation_message_id(field)
+
+      if messages.any?
+        @template.tag.with_options id: id, **attributes do |tag|
+          if block_given?
+            yield messages, tag
+          else
+            tag.span(messages.to_sentence)
+          end
+        end
+      end
+    end
+  end
+
</span>   def validation_message_id(field)
     if errors(field).any?
       field_id(field, :validation_message)
</code></pre></div></details>

              <details
  id="test/controllers/authentications_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/authentications_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/authentications_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/authentications_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/authentications_controller_test.rb b/test/controllers/authentications_controller_test.rb
index 659e9bf..04e9c2d 100644
</span><span class="gd">--- a/test/controllers/authentications_controller_test.rb
</span><span class="gi">+++ b/test/controllers/authentications_controller_test.rb
</span><span class="p">@@ -8,6 +8,14 @@</span> class AuthenticationsControllerTest &lt; ActionDispatch::IntegrationTest
     assert_redirected_to messages_url
   end
 
<span class="gi">+  test "#new renders a fresh Authentication form" do
+    get new_authentication_path
+
+    assert_response :success
+    assert_select "input:not([aria-invalid]):not([aria-describedby])#authentication_username ~ span", count: 0
+    assert_select "input:not([aria-invalid]):not([aria-describedby])#authentication_password ~ span", count: 0
+  end
+
</span>   test "#create with a valid username/password pairing writes to the session" do
     alice = users(:alice)
 
<span class="p">@@ -30,9 +38,9 @@</span> class AuthenticationsControllerTest &lt; ActionDispatch::IntegrationTest
     assert_redirected_to(new_authentication_url).then { follow_redirect! }
     assert_flash_params({ authentication: { username: "" } })
     assert_nil session[:user_id]
<span class="gd">-    assert_select "#authentication_username_validation_message", text: "can't be blank"
</span><span class="gi">+    assert_select "input#authentication_username ~ #authentication_username_validation_message", text: "can't be blank"
</span>     assert_select %(input[type="text"][aria-invalid="true"][aria-describedby~="authentication_username_validation_message"])
<span class="gd">-    assert_select "#authentication_password_validation_message", text: "can't be blank"
</span><span class="gi">+    assert_select "input#authentication_password ~ #authentication_password_validation_message", text: "can't be blank"
</span>     assert_select %(input[type="password"][aria-invalid="true"][aria-describedby~="authentication_password_validation_message"])
   end
 
<span class="p">@@ -49,7 +57,7 @@</span> class AuthenticationsControllerTest &lt; ActionDispatch::IntegrationTest
     assert_redirected_to(new_authentication_url).then { follow_redirect! }
     assert_flash_params({ authentication: { username: alice.username } })
     assert_nil session[:user_id]
<span class="gd">-    assert_select %(span[aria-live="assertive"]), text: "is invalid"
</span><span class="gi">+    assert_select %(p[aria-live="assertive"][id="authentication_base_validation_message"]), text: "is invalid", count: 1
</span>     assert_select %(input[type="text"][value="#{alice.username}"])
     assert_select %(input[type="password"]:not([value]))
   end
</code></pre></div></details>

              <details
  id="test/controllers/messages_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/messages_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/messages_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/messages_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/messages_controller_test.rb b/test/controllers/messages_controller_test.rb
index 7b91666..f63e917 100644
</span><span class="gd">--- a/test/controllers/messages_controller_test.rb
</span><span class="gi">+++ b/test/controllers/messages_controller_test.rb
</span><span class="p">@@ -41,7 +41,8 @@</span> class MessagesControllerTest &lt; ActionDispatch::IntegrationTest
     get messages_path
 
     assert_response :success
<span class="gd">-    assert_select "#message_content_validation_message", count: 0
</span><span class="gi">+    assert_select "trix-editor#message_content ~ #message_content_validation_message", count: 0
+    assert_select "trix-editor#message_content ~ span", count: 0
</span>     assert_select %{trix-editor:not([aria-invalid="true"]):not([aria-describedby])}
   end
 
<span class="p">@@ -52,7 +53,7 @@</span> class MessagesControllerTest &lt; ActionDispatch::IntegrationTest
     }
 
     assert_redirected_to(messages_url).then { follow_redirect! }
<span class="gd">-    assert_select "#message_content_validation_message", "can't be blank"
</span><span class="gi">+    assert_select "trix-editor#message_content ~ #message_content_validation_message", "can't be blank"
</span>     assert_select %{trix-editor[aria-invalid="true"][aria-describedby~="message_content_validation_message"]}
   end
 end
</code></pre></div></details>

          </aside>
      </article>
    </main>
  </body>
</html>
